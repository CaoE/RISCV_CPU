riscv32-unknown-elf-g++ -march=rv32i -mabi=ilp32 -c -O2 -o example.o example.cpp
riscv32-unknown-elf-ld example.o rom.o system.o -o example.om -T memory.ld -L /opt/riscv/riscv32-unknown-elf/lib/ -L /opt/riscv/lib/gcc/riscv32-unknown-elf/7.2.0/ -lc -lgcc -lm -lnosys
riscv32-unknown-elf-objdump example.om -d

example.om:     file format elf32-littleriscv


Disassembly of section .rom:

00000000 <.rom>:
   0:	10000137          	lui	sp,0x10000
   4:	fe212e23          	sw	sp,-4(sp) # ffffffc <__heap_start+0xfffdffc>
   8:	094010ef          	jal	ra,109c <main>
   c:	0ff00513          	li	a0,255
  10:	10a00423          	sb	a0,264(zero) # 108 <sbrk-0xef8>
  14:	0000006f          	j	14 <sbrk-0xfec>

Disassembly of section .text:

00001000 <sbrk>:
    1000:	00001737          	lui	a4,0x1
    1004:	13c72783          	lw	a5,316(a4) # 113c <__bss_start>
    1008:	00a78533          	add	a0,a5,a0
    100c:	12a72e23          	sw	a0,316(a4)
    1010:	00078513          	mv	a0,a5
    1014:	00008067          	ret

00001018 <write>:
    1018:	00100793          	li	a5,1
    101c:	02f51263          	bne	a0,a5,1040 <write+0x28>
    1020:	00060c63          	beqz	a2,1038 <write+0x20>
    1024:	00c58733          	add	a4,a1,a2
    1028:	0005c783          	lbu	a5,0(a1)
    102c:	00158593          	addi	a1,a1,1
    1030:	10f00223          	sb	a5,260(zero) # 104 <sbrk-0xefc>
    1034:	fee59ae3          	bne	a1,a4,1028 <write+0x10>
    1038:	00060513          	mv	a0,a2
    103c:	00008067          	ret
    1040:	fff00513          	li	a0,-1
    1044:	00008067          	ret

00001048 <read>:
    1048:	04051663          	bnez	a0,1094 <read+0x4c>
    104c:	02060a63          	beqz	a2,1080 <read+0x38>
    1050:	10002783          	lw	a5,256(zero) # 100 <sbrk-0xf00>
    1054:	fff00713          	li	a4,-1
    1058:	02e78a63          	beq	a5,a4,108c <read+0x44>
    105c:	00000513          	li	a0,0
    1060:	fff00713          	li	a4,-1
    1064:	0100006f          	j	1074 <read+0x2c>
    1068:	10002783          	lw	a5,256(zero) # 100 <sbrk-0xf00>
    106c:	00158593          	addi	a1,a1,1
    1070:	00e78c63          	beq	a5,a4,1088 <read+0x40>
    1074:	00f58023          	sb	a5,0(a1)
    1078:	00150513          	addi	a0,a0,1
    107c:	fea616e3          	bne	a2,a0,1068 <read+0x20>
    1080:	00060513          	mv	a0,a2
    1084:	00008067          	ret
    1088:	00008067          	ret
    108c:	00000513          	li	a0,0
    1090:	00008067          	ret
    1094:	fff00513          	li	a0,-1
    1098:	00008067          	ret

Disassembly of section .text.startup:

0000109c <main>:
    109c:	000017b7          	lui	a5,0x1
    10a0:	04800713          	li	a4,72
    10a4:	0c878793          	addi	a5,a5,200 # 10c8 <main+0x2c>
    10a8:	10e00223          	sb	a4,260(zero) # 104 <sbrk-0xefc>
    10ac:	00178793          	addi	a5,a5,1
    10b0:	0007c703          	lbu	a4,0(a5)
    10b4:	fe071ae3          	bnez	a4,10a8 <main+0xc>
    10b8:	00a00793          	li	a5,10
    10bc:	10f00223          	sb	a5,260(zero) # 104 <sbrk-0xefc>
    10c0:	00000513          	li	a0,0
    10c4:	00008067          	ret
rm example.om example.o
